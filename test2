--[[
    Avenir Library
    -> Originally made by @finobe 
    -> Modified with auto-load config, notification control
]]

-- Variables 
    local uis = game:GetService("UserInputService") 
    local players = game:GetService("Players") 
    local ws = game:GetService("Workspace")
    local rs = game:GetService("ReplicatedStorage")
    local http_service = game:GetService("HttpService")
    local gui_service = game:GetService("GuiService")
    local lighting = game:GetService("Lighting")
    local run = game:GetService("RunService")
    local stats = game:GetService("Stats")
    local coregui = game:GetService("CoreGui")
    local debris = game:GetService("Debris")
    local tween_service = game:GetService("TweenService")
    local sound_service = game:GetService("SoundService")

    local vec2 = Vector2.new
    local vec3 = Vector3.new
    local dim2 = UDim2.new
    local dim = UDim.new 
    local rect = Rect.new
    local cfr = CFrame.new
    local empty_cfr = cfr()
    local point_object_space = empty_cfr.PointToObjectSpace
    local angle = CFrame.Angles
    local dim_offset = UDim2.fromOffset

    local color = Color3.new
    local rgb = Color3.fromRGB
    local hex = Color3.fromHex
    local hsv = Color3.fromHSV
    local rgbseq = ColorSequence.new
    local rgbkey = ColorSequenceKeypoint.new
    local numseq = NumberSequence.new
    local numkey = NumberSequenceKeypoint.new

    local camera = ws.CurrentCamera
    local lp = players.LocalPlayer 
    local mouse = lp:GetMouse() 
    local gui_offset = gui_service:GetGuiInset().Y

    local max = math.max 
    local floor = math.floor 
    local min = math.min 
    local abs = math.abs 
    local noise = math.noise
    local rad = math.rad 
    local random = math.random 
    local pow = math.pow 
    local sin = math.sin 
    local pi = math.pi 
    local tan = math.tan 
    local atan2 = math.atan2 
    local clamp = math.clamp 

    local insert = table.insert 
    local find = table.find 
    local remove = table.remove
    local concat = table.concat
-- 

-- Library init
    getgenv().library = {
        directory = "avenir",
        folders = {
            "/fonts",
            "/configs",
        },
        flags = {},
        config_flags = {},
        connections = {},   
        notifications = {
            notifs = {},
            enabled = false,
        },
        auto_load_config_name = nil,
        notifications_on = false,
        current_open = nil,
    }

    local themes = {
        preset = {
            accent = rgb(155, 150, 219),
        }, 

        utility = {
            accent = {
                BackgroundColor3 = {},  
                TextColor3 = {}, 
                ImageColor3 = {}, 
                ScrollBarImageColor3 = {} 
            },
        }
    }

    local keys = {
        [Enum.KeyCode.LeftShift] = "LS",
        [Enum.KeyCode.RightShift] = "RS",
        [Enum.KeyCode.LeftControl] = "LC",
        [Enum.KeyCode.RightControl] = "RC",
        [Enum.KeyCode.Insert] = "INS",
        [Enum.KeyCode.Backspace] = "BS",
        [Enum.KeyCode.Return] = "Ent",
        [Enum.KeyCode.LeftAlt] = "LA",
        [Enum.KeyCode.RightAlt] = "RA",
        [Enum.KeyCode.CapsLock] = "CAPS",
        [Enum.KeyCode.One] = "1",
        [Enum.KeyCode.Two] = "2",
        [Enum.KeyCode.Three] = "3",
        [Enum.KeyCode.Four] = "4",
        [Enum.KeyCode.Five] = "5",
        [Enum.KeyCode.Six] = "6",
        [Enum.KeyCode.Seven] = "7",
        [Enum.KeyCode.Eight] = "8",
        [Enum.KeyCode.Nine] = "9",
        [Enum.KeyCode.Zero] = "0",
        [Enum.KeyCode.KeypadOne] = "Num1",
        [Enum.KeyCode.KeypadTwo] = "Num2",
        [Enum.KeyCode.KeypadThree] = "Num3",
        [Enum.KeyCode.KeypadFour] = "Num4",
        [Enum.KeyCode.KeypadFive] = "Num5",
        [Enum.KeyCode.KeypadSix] = "Num6",
        [Enum.KeyCode.KeypadSeven] = "Num7",
        [Enum.KeyCode.KeypadEight] = "Num8",
        [Enum.KeyCode.KeypadNine] = "Num9",
        [Enum.KeyCode.KeypadZero] = "Num0",
        [Enum.KeyCode.Minus] = "-",
        [Enum.KeyCode.Equals] = "=",
        [Enum.KeyCode.Tilde] = "~",
        [Enum.KeyCode.LeftBracket] = "[",
        [Enum.KeyCode.RightBracket] = "]",
        [Enum.KeyCode.RightParenthesis] = ")",
        [Enum.KeyCode.LeftParenthesis] = "(",
        [Enum.KeyCode.Semicolon] = ",",
        [Enum.KeyCode.Quote] = "'",
        [Enum.KeyCode.BackSlash] = "\\",
        [Enum.KeyCode.Comma] = ",",
        [Enum.KeyCode.Period] = ".",
        [Enum.KeyCode.Slash] = "/",
        [Enum.KeyCode.Asterisk] = "*",
        [Enum.KeyCode.Plus] = "+",
        [Enum.KeyCode.Backquote] = "`",
        [Enum.UserInputType.MouseButton1] = "MB1",
        [Enum.UserInputType.MouseButton2] = "MB2",
        [Enum.UserInputType.MouseButton3] = "MB3",
        [Enum.KeyCode.Escape] = "ESC",
        [Enum.KeyCode.Space] = "SPC",
    }
        
    library.__index = library

    pcall(function()
        for _, path in next, library.folders do 
            if not isfolder(library.directory .. path) then
                makefolder(library.directory .. path)
            end
        end
    end)

    local flags = library.flags 
    local config_flags = library.config_flags
    local notifications = library.notifications 

    local fonts = {}
    
    pcall(function()
        local function Register_Font(Name, Weight, Style, Asset)
            if not isfile(Asset.Id) then
                writefile(Asset.Id, Asset.Font)
            end

            if isfile(Name .. ".font") then
                delfile(Name .. ".font")
            end

            local Data = {
                name = Name,
                faces = {
                    {
                        name = "Normal",
                        weight = Weight,
                        style = Style,
                        assetId = getcustomasset(Asset.Id),
                    },
                },
            }

            writefile(Name .. ".font", http_service:JSONEncode(Data))
            return getcustomasset(Name .. ".font")
        end
        
        local Medium = Register_Font("Medium", 200, "Normal", {
            Id = "Medium.ttf",
            Font = game:HttpGet("https://github.com/i77lhm/storage/raw/refs/heads/main/fonts/Inter_28pt-Medium.ttf"),
        })

        local SemiBold = Register_Font("SemiBold", 200, "Normal", {
            Id = "SemiBold.ttf",
            Font = game:HttpGet("https://github.com/i77lhm/storage/raw/refs/heads/main/fonts/Inter_28pt-SemiBold.ttf"),
        })

        fonts = {
            small = Font.new(Medium, Enum.FontWeight.Regular, Enum.FontStyle.Normal),
            font = Font.new(SemiBold, Enum.FontWeight.Regular, Enum.FontStyle.Normal),
        }
    end)
    
    if not fonts.small then
        fonts.small = Font.fromEnum(Enum.Font.Gotham)
        fonts.font = Font.fromEnum(Enum.Font.GothamBold)
    end
--

-- Library functions 
    function library:tween(obj, properties, easing_style, time) 
        local tween = tween_service:Create(obj, TweenInfo.new(time or 0.25, easing_style or Enum.EasingStyle.Quint, Enum.EasingDirection.InOut, 0, false, 0), properties):Play()
        return tween
    end

    function library:resizify(frame) 
        local Frame = Instance.new("TextButton")
        Frame.Position = dim2(1, -10, 1, -10)
        Frame.BorderColor3 = rgb(0, 0, 0)
        Frame.Size = dim2(0, 10, 0, 10)
        Frame.BorderSizePixel = 0
        Frame.BackgroundColor3 = rgb(255, 255, 255)
        Frame.Parent = frame
        Frame.BackgroundTransparency = 1 
        Frame.Text = ""

        local resizing = false 
        local start_size 
        local start 
        local og_size = frame.Size  

        Frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                resizing = true
                start = input.Position
                start_size = frame.Size
            end
        end)

        Frame.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                resizing = false
            end
        end)

        library:connection(uis.InputChanged, function(input, game_event) 
            if resizing and input.UserInputType == Enum.UserInputType.MouseMovement then
                local viewport_x = camera.ViewportSize.X
                local viewport_y = camera.ViewportSize.Y

                local current_size = dim2(
                    start_size.X.Scale,
                    math.clamp(start_size.X.Offset + (input.Position.X - start.X), og_size.X.Offset, viewport_x),
                    start_size.Y.Scale,
                    math.clamp(start_size.Y.Offset + (input.Position.Y - start.Y), og_size.Y.Offset, viewport_y)
                )

                library:tween(frame, {Size = current_size}, Enum.EasingStyle.Linear, 0.05)
            end
        end)
    end 

    function library:next_flag()
        local index = 0
        for _ in pairs(library.flags) do
            index = index + 1
        end
        return string.format("flag_%s", index + 1)
    end 

    function library:mouse_in_frame(uiobject)
        local y_cond = uiobject.AbsolutePosition.Y <= mouse.Y and mouse.Y <= uiobject.AbsolutePosition.Y + uiobject.AbsoluteSize.Y
        local x_cond = uiobject.AbsolutePosition.X <= mouse.X and mouse.X <= uiobject.AbsolutePosition.X + uiobject.AbsoluteSize.X
        return (y_cond and x_cond)
    end

    function library:draggify(frame)
        local dragging = false 
        local start_size = frame.Position
        local start 

        frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                start = input.Position
                start_size = frame.Position
            end
        end)

        frame.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)

        library:connection(uis.InputChanged, function(input, game_event) 
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local viewport_x = camera.ViewportSize.X
                local viewport_y = camera.ViewportSize.Y

                local current_position = dim2(
                    0,
                    clamp(start_size.X.Offset + (input.Position.X - start.X), 0, viewport_x - frame.Size.X.Offset),
                    0,
                    clamp(start_size.Y.Offset + (input.Position.Y - start.Y), 0, viewport_y - frame.Size.Y.Offset)
                )

                library:tween(frame, {Position = current_position}, Enum.EasingStyle.Linear, 0.05)
                library:close_element()
            end
        end)
    end 

    function library:convert(str)
        local values = {}
        for value in string.gmatch(str, "[^,]+") do
            insert(values, tonumber(value))
        end
        if #values == 4 then              
            return unpack(values)
        end
        return nil
    end
    
    function library:convert_enum(enum)
        local enum_parts = {}
        for part in string.gmatch(enum, "[%w_]+") do
            insert(enum_parts, part)
        end
        local enum_table = Enum
        for i = 2, #enum_parts do
            enum_table = enum_table[enum_parts[i]]
        end
        return enum_table
    end

    function library:get_settings_path()
        return library.directory .. "/library_settings.json"
    end

    function library:save_library_settings()
        local settings_data = {
            auto_load_config = library.auto_load_config_name,
            notifications_enabled = library.notifications_on,
        }
        pcall(function()
            writefile(library:get_settings_path(), http_service:JSONEncode(settings_data))
        end)
    end

    function library:load_library_settings()
        local path = library:get_settings_path()
        pcall(function()
            if isfile(path) then
                local data = http_service:JSONDecode(readfile(path))
                library.auto_load_config_name = data.auto_load_config
                library.notifications_on = data.notifications_enabled or false
                notifications.enabled = library.notifications_on
            end
        end)
    end

    function library:set_auto_load(config_name)
        library.auto_load_config_name = config_name
        library:save_library_settings()
    end

    function library:clear_auto_load()
        library.auto_load_config_name = nil
        library:save_library_settings()
    end

    function library:toggle_notifications(enabled)
        library.notifications_on = enabled
        notifications.enabled = enabled
        library:save_library_settings()
    end

    function library:do_auto_load()
        library:load_library_settings()
        if library.auto_load_config_name then
            local config_path = library.directory .. "/configs/" .. library.auto_load_config_name .. ".cfg"
            pcall(function()
                if isfile(config_path) then
                    task.spawn(function()
                        task.wait(0.5)
                        library:load_config(readfile(config_path))
                        if notifications.enabled then
                            notifications:create_notification({
                                name = "Auto Load",
                                info = "Loaded: " .. library.auto_load_config_name
                            })
                        end
                    end)
                end
            end)
        end
    end

    local config_holder
    function library:update_config_list() 
        if not config_holder then return end
        
        local list = {}
        pcall(function()
            for _, file in ipairs(listfiles(library.directory .. "/configs")) do
                local name = file:match("([^/\\]+)%.cfg$")
                if name then
                    list[#list + 1] = name
                end
            end
        end)
        
        if #list == 0 then
            list = {"No Configs"}
        end
        config_holder.refresh_options(list)
    end 

    function library:get_config()
        local Config = {}
        for flag, value in pairs(flags) do
            if type(value) == "table" and value.key then
                Config[flag] = {active = value.active, mode = value.mode, key = tostring(value.key)}
            elseif type(value) == "table" and value["Transparency"] and value["Color"] then
                Config[flag] = {Transparency = value["Transparency"], Color = value["Color"]:ToHex()}
            else
                Config[flag] = value
            end
        end 
        return http_service:JSONEncode(Config)
    end

    function library:load_config(config_json) 
        local success, config = pcall(function()
            return http_service:JSONDecode(config_json)
        end)
        
        if not success then return end
        
        for flag, value in pairs(config) do 
            local setter = config_flags[flag]
            if flag == "config_name_list" then continue end
            if setter then 
                pcall(function()
                    if type(value) == "table" and value["Transparency"] and value["Color"] then
                        setter(hex(value["Color"]), value["Transparency"])
                    elseif type(value) == "table" and value["active"] then 
                        setter(value)
                    else
                        setter(value)
                    end
                end)
            end 
        end 
    end 
    
    function library:round(number, float) 
        local multiplier = 1 / (float or 1)
        return floor(number * multiplier + 0.5) / multiplier
    end 

    function library:apply_theme(instance, theme, property) 
        insert(themes.utility[theme][property], instance)
    end

    function library:update_theme(theme, new_color)
        for property, objects in pairs(themes.utility[theme]) do 
            for _, object in pairs(objects) do 
                pcall(function()
                    if object[property] then
                        object[property] = new_color
                    end
                end)
            end 
        end 
        themes.preset[theme] = new_color
    end 

    function library:connection(signal, callback)
        local connection = signal:Connect(callback)
        insert(library.connections, connection)
        return connection 
    end

    function library:close_element(new_path) 
        local open_element = library.current_open
        if open_element and new_path ~= open_element then
            pcall(function()
                open_element.set_visible(false)
                open_element.open = false
            end)
        end 
        if new_path ~= open_element then 
            library.current_open = new_path or nil
        end
    end 

    function library:create(instance, options)
        local ins = Instance.new(instance) 
        for prop, value in pairs(options) do 
            pcall(function()
                ins[prop] = value
            end)
        end
        return ins 
    end

    function library:unload_menu() 
        pcall(function()
            if library["items"] then 
                library["items"]:Destroy()
            end
            if library["other"] then 
                library["other"]:Destroy()
            end 
            for _, connection in pairs(library.connections) do 
                connection:Disconnect() 
            end
        end)
    end 
--

-- Window
    function library:window(properties)
        local cfg = { 
            suffix = properties.suffix or "tech",
            name = properties.name or "avenir",
            game_name = properties.gameInfo or "Avenir UI",
            size = properties.size or dim2(0, 700, 0, 565),
            selected_tab = nil,
            items = {},
        }
        
        library["items"] = library:create("ScreenGui", {
            Parent = coregui,
            Name = "AvenirUI",
            Enabled = true,
            ZIndexBehavior = Enum.ZIndexBehavior.Global,
            IgnoreGuiInset = true,
        })
        
        library["other"] = library:create("ScreenGui", {
            Parent = coregui,
            Name = "AvenirOther",
            Enabled = false,
            ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
            IgnoreGuiInset = true,
        })

        local items = cfg.items
        
        items["main"] = library:create("Frame", {
            Parent = library["items"],
            Size = cfg.size,
            Position = dim2(0.5, -cfg.size.X.Offset / 2, 0.5, -cfg.size.Y.Offset / 2),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(14, 14, 16)
        })
        items["main"].Position = dim2(0, items["main"].AbsolutePosition.X, 0, items["main"].AbsolutePosition.Y)
        
        library:create("UICorner", {
            Parent = items["main"],
            CornerRadius = dim(0, 10)
        })
        
        library:create("UIStroke", {
            Color = rgb(23, 23, 29),
            Parent = items["main"],
            ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        })
        
        items["side_frame"] = library:create("Frame", {
            Parent = items["main"],
            BackgroundTransparency = 1,
            Size = dim2(0, 196, 1, -25),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(14, 14, 16)
        })
        
        library:create("Frame", {
            AnchorPoint = vec2(1, 0),
            Parent = items["side_frame"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(0, 1, 1, 0),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(21, 21, 23)
        })
        
        items["button_holder"] = library:create("Frame", {
            Parent = items["side_frame"],
            BackgroundTransparency = 1,
            Position = dim2(0, 0, 0, 60),
            Size = dim2(1, 0, 1, -60),
            BorderSizePixel = 0,
        })
        cfg.button_holder = items["button_holder"]
        
        library:create("UIListLayout", {
            Parent = items["button_holder"],
            Padding = dim(0, 5),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        library:create("UIPadding", {
            PaddingTop = dim(0, 16),
            PaddingBottom = dim(0, 36),
            Parent = items["button_holder"],
            PaddingRight = dim(0, 11),
            PaddingLeft = dim(0, 10)
        })

        items["title"] = library:create("TextLabel", {
            FontFace = fonts.font,
            Parent = items["side_frame"],
            Text = string.format('<u>%s</u><font color="rgb(255,255,255)">%s</font>', cfg.name, cfg.suffix),
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 70),
            TextColor3 = themes.preset.accent,
            BorderSizePixel = 0,
            RichText = true,
            TextSize = 30,
        })
        library:apply_theme(items["title"], "accent", "TextColor3")
        
        items["multi_holder"] = library:create("Frame", {
            Parent = items["main"],
            BackgroundTransparency = 1,
            Position = dim2(0, 196, 0, 0),
            Size = dim2(1, -196, 0, 56),
            BorderSizePixel = 0,
        })
        cfg.multi_holder = items["multi_holder"]
        
        library:create("Frame", {
            AnchorPoint = vec2(0, 1),
            Parent = items["multi_holder"],
            Position = dim2(0, 0, 1, 0),
            Size = dim2(1, 0, 0, 1),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(21, 21, 23)
        })
        
        items["global_fade"] = library:create("Frame", {
            Parent = items["main"],
            BackgroundTransparency = 1,
            Position = dim2(0, 196, 0, 56),
            Size = dim2(1, -196, 1, -81),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(14, 14, 16),
            ZIndex = 2,
        })
        
        items["info"] = library:create("Frame", {
            AnchorPoint = vec2(0, 1),
            Parent = items["main"],
            Position = dim2(0, 0, 1, 0),
            Size = dim2(1, 0, 0, 25),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(23, 23, 25)
        })
        
        library:create("UICorner", {
            Parent = items["info"],
            CornerRadius = dim(0, 10)
        })
        
        library:create("Frame", {
            Parent = items["info"],
            Size = dim2(1, 0, 0, 6),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(23, 23, 25)
        })
        
        library:create("TextLabel", {
            FontFace = fonts.font,
            Parent = items["info"],
            TextColor3 = rgb(72, 72, 73),
            Text = cfg.game_name,
            Size = dim2(1, 0, 0, 0),
            AnchorPoint = vec2(0, 0.5),
            Position = dim2(0, 10, 0.5, -1),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 14,
        })

        library:draggify(items["main"])
        library:resizify(items["main"])

        function cfg.toggle_menu(bool) 
            library["items"].Enabled = bool
        end 
            
        return setmetatable(cfg, library)
    end 
--

-- Tab
    function library:tab(properties)
        local cfg = {
            name = properties.name or "Tab", 
            icon = properties.icon or "http://www.roblox.com/asset/?id=6034767608",
            tabs = properties.tabs or {"Main"},
            pages = {},
            current_multi = nil, 
            items = {},
        } 

        local items = cfg.items
        
        items["tab_holder"] = library:create("Frame", {
            Parent = library.cache,
            Visible = false,
            BackgroundTransparency = 1,
            Position = dim2(0, 196, 0, 56),
            Size = dim2(1, -216, 1, -101),
            BorderSizePixel = 0,
        })
        
        items["button"] = library:create("TextButton", {
            FontFace = fonts.font,
            TextColor3 = rgb(255, 255, 255),
            Text = "",
            Parent = self.items["button_holder"],
            AutoButtonColor = false,
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 35),
            BorderSizePixel = 0,
            TextSize = 16,
            BackgroundColor3 = rgb(29, 29, 29)
        })
        
        items["icon"] = library:create("ImageLabel", {
            ImageColor3 = rgb(72, 72, 73),
            Parent = items["button"],
            AnchorPoint = vec2(0, 0.5),
            Image = cfg.icon,
            BackgroundTransparency = 1,
            Position = dim2(0, 10, 0.5, 0),
            Size = dim2(0, 22, 0, 22),
            BorderSizePixel = 0,
        })
        library:apply_theme(items["icon"], "accent", "ImageColor3")
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(72, 72, 73),
            Text = cfg.name,
            Parent = items["button"],
            Size = dim2(0, 0, 1, 0),
            Position = dim2(0, 40, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.X,
            TextSize = 16,
        })
        
        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })
        
        library:create("UICorner", {
            Parent = items["button"],
            CornerRadius = dim(0, 7)
        })

        items["multi_section_button_holder"] = library:create("Frame", {
            Parent = library.cache,
            BackgroundTransparency = 1,
            Visible = false,
            Size = dim2(1, 0, 1, 0),
            BorderSizePixel = 0,
        })
        
        library:create("UIListLayout", {
            Parent = items["multi_section_button_holder"],
            Padding = dim(0, 7),
            SortOrder = Enum.SortOrder.LayoutOrder,
            FillDirection = Enum.FillDirection.Horizontal
        })
        
        library:create("UIPadding", {
            PaddingTop = dim(0, 8),
            PaddingBottom = dim(0, 7),
            Parent = items["multi_section_button_holder"],
            PaddingRight = dim(0, 7),
            PaddingLeft = dim(0, 7)
        })

        for _, section in ipairs(cfg.tabs) do
            local data = {items = {}} 
            local multi_items = data.items
            
            multi_items["button"] = library:create("TextButton", {
                FontFace = fonts.font,
                TextColor3 = rgb(255, 255, 255),
                AutoButtonColor = false,
                Text = "",
                Parent = items["multi_section_button_holder"],
                Size = dim2(0, 0, 0, 39),
                BackgroundTransparency = 1,
                ClipsDescendants = true,
                BorderSizePixel = 0,
                AutomaticSize = Enum.AutomaticSize.X,
                TextSize = 16,
                BackgroundColor3 = rgb(25, 25, 29)
            })
            
            multi_items["name"] = library:create("TextLabel", {
                FontFace = fonts.font,
                TextColor3 = rgb(62, 62, 63),
                Text = section,
                Parent = multi_items["button"],
                Size = dim2(0, 0, 1, 0),
                BackgroundTransparency = 1,
                TextXAlignment = Enum.TextXAlignment.Left,
                BorderSizePixel = 0,
                AutomaticSize = Enum.AutomaticSize.XY,
                TextSize = 16,
            })
            
            library:create("UIPadding", {
                Parent = multi_items["name"],
                PaddingRight = dim(0, 5),
                PaddingLeft = dim(0, 5)
            })
            
            multi_items["accent"] = library:create("Frame", {
                AnchorPoint = vec2(0, 1),
                Parent = multi_items["button"],
                BackgroundTransparency = 1,
                Position = dim2(0, 10, 1, 4),
                Size = dim2(1, -20, 0, 6),
                BorderSizePixel = 0,
                BackgroundColor3 = themes.preset.accent
            })
            library:apply_theme(multi_items["accent"], "accent", "BackgroundColor3")
            
            library:create("UICorner", {
                Parent = multi_items["accent"],
                CornerRadius = dim(0, 999)
            })
            
            library:create("UIPadding", {
                Parent = multi_items["button"],
                PaddingRight = dim(0, 10),
                PaddingLeft = dim(0, 10)
            })
            
            library:create("UICorner", {
                Parent = multi_items["button"],
                CornerRadius = dim(0, 7)
            })

            multi_items["tab"] = library:create("Frame", {
                Parent = library.cache,
                BackgroundTransparency = 1,
                Size = dim2(1, -20, 1, -20),
                BorderSizePixel = 0,
                Visible = false,
            })
            
            library:create("UIListLayout", {
                FillDirection = Enum.FillDirection.Vertical,
                HorizontalFlex = Enum.UIFlexAlignment.Fill,
                Parent = multi_items["tab"],
                Padding = dim(0, 7),
                SortOrder = Enum.SortOrder.LayoutOrder,
                VerticalFlex = Enum.UIFlexAlignment.Fill
            })
            
            library:create("UIPadding", {
                PaddingTop = dim(0, 7),
                PaddingBottom = dim(0, 7),
                Parent = multi_items["tab"],
                PaddingRight = dim(0, 7),
                PaddingLeft = dim(0, 7)
            })

            data.text = multi_items["name"]
            data.accent = multi_items["accent"]
            data.button = multi_items["button"]
            data.page = multi_items["tab"]
            
            local sub = setmetatable(data, library):sub_tab({})
            data.parent = sub.items["tab_parent"]

            function data.open_page()
                local page = cfg.current_multi
                
                if page and page.text ~= data.text then 
                    self.items["global_fade"].BackgroundTransparency = 0
                    library:tween(self.items["global_fade"], {BackgroundTransparency = 1}, Enum.EasingStyle.Quad, 0.4)
                    page.page.Size = dim2(1, -20, 1, -20)
                end

                if page then
                    library:tween(page.text, {TextColor3 = rgb(62, 62, 63)})
                    library:tween(page.accent, {BackgroundTransparency = 1})
                    library:tween(page.button, {BackgroundTransparency = 1})
                    page.page.Visible = false
                    page.page.Parent = library["cache"] 
                end 
                
                library:tween(data.text, {TextColor3 = rgb(255, 255, 255)})
                library:tween(data.accent, {BackgroundTransparency = 0})
                library:tween(data.button, {BackgroundTransparency = 0})
                library:tween(data.page, {Size = dim2(1, 0, 1, 0)}, Enum.EasingStyle.Quad, 0.4)

                data.page.Visible = true
                data.page.Parent = items["tab_holder"]
                cfg.current_multi = data
                library:close_element()
            end

            multi_items["button"].MouseButton1Down:Connect(function()
                data.open_page() 
            end)

            cfg.pages[#cfg.pages + 1] = setmetatable(data, library)
        end 

        cfg.pages[1].open_page()

        function cfg.open_tab() 
            local selected_tab = self.selected_tab
            
            if selected_tab then 
                if selected_tab[4] ~= items["tab_holder"] then 
                    self.items["global_fade"].BackgroundTransparency = 0
                    library:tween(self.items["global_fade"], {BackgroundTransparency = 1}, Enum.EasingStyle.Quad, 0.4)
                    selected_tab[4].Size = dim2(1, -216, 1, -101)
                end

                library:tween(selected_tab[1], {BackgroundTransparency = 1})
                library:tween(selected_tab[2], {ImageColor3 = rgb(72, 72, 73)})
                library:tween(selected_tab[3], {TextColor3 = rgb(72, 72, 73)})

                selected_tab[4].Visible = false
                selected_tab[4].Parent = library["cache"]
                selected_tab[5].Visible = false
                selected_tab[5].Parent = library["cache"]
            end

            library:tween(items["button"], {BackgroundTransparency = 0})
            library:tween(items["icon"], {ImageColor3 = themes.preset.accent})
            library:tween(items["name"], {TextColor3 = rgb(255, 255, 255)})
            library:tween(items["tab_holder"], {Size = dim2(1, -196, 1, -81)}, Enum.EasingStyle.Quad, 0.4)
            
            items["tab_holder"].Visible = true 
            items["tab_holder"].Parent = self.items["main"]
            items["multi_section_button_holder"].Visible = true 
            items["multi_section_button_holder"].Parent = self.items["multi_holder"]

            self.selected_tab = {
                items["button"],
                items["icon"],
                items["name"],
                items["tab_holder"],
                items["multi_section_button_holder"],
            }

            library:close_element()
        end

        items["button"].MouseButton1Down:Connect(function()
            cfg.open_tab()
        end)
        
        if not self.selected_tab then 
            cfg.open_tab() 
        end

        return unpack(cfg.pages)
    end

    function library:seperator(properties)
        local cfg = {items = {}, name = properties.name or "General"}
        local items = cfg.items
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(72, 72, 73),
            Text = cfg.name,
            Parent = self.items["button_holder"],
            Size = dim2(1, 0, 0, 0),
            Position = dim2(0, 40, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })
        
        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })

        return setmetatable(cfg, library)
    end 

    function library:column(properties) 
        local cfg = {items = {}, size = properties.size or 1}
        local items = cfg.items
        
        items["column"] = library:create("Frame", {
            Parent = self["parent"] or self.items["tab_parent"],
            BackgroundTransparency = 1,
            Size = dim2(0, 0, cfg.size, 0),
            BorderSizePixel = 0,
        })
        
        library:create("UIPadding", {
            PaddingBottom = dim(0, 10),
            Parent = items["column"]
        })
        
        library:create("UIListLayout", {
            Parent = items["column"],
            HorizontalFlex = Enum.UIFlexAlignment.Fill,
            Padding = dim(0, 10),
            FillDirection = Enum.FillDirection.Vertical,
            SortOrder = Enum.SortOrder.LayoutOrder
        })

        return setmetatable(cfg, library)
    end 

    function library:sub_tab(properties) 
        local cfg = {items = {}, size = properties.size or 1}
        local items = cfg.items
        
        items["tab_parent"] = library:create("Frame", {
            Parent = self.items["tab"],
            BackgroundTransparency = 1,
            Size = dim2(0, 0, cfg.size, 0),
            BorderSizePixel = 0,
            Visible = true,
        })
        
        library:create("UIListLayout", {
            FillDirection = Enum.FillDirection.Horizontal,
            HorizontalFlex = Enum.UIFlexAlignment.Fill,
            VerticalFlex = Enum.UIFlexAlignment.Fill,
            Parent = items["tab_parent"],
            Padding = dim(0, 7),
            SortOrder = Enum.SortOrder.LayoutOrder,
        })

        return setmetatable(cfg, library)
    end 
--

-- Section
    function library:section(properties)
        local cfg = {
            name = properties.name or "Section", 
            size = properties.size or 0.5, 
            icon = properties.icon or "http://www.roblox.com/asset/?id=6022668898",
            items = {},
        }
        
        local items = cfg.items
        
        items["outline"] = library:create("Frame", {
            Parent = self.items["column"],
            Size = dim2(0, 0, cfg.size, -3),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(25, 25, 29)
        })

        library:create("UICorner", {
            Parent = items["outline"],
            CornerRadius = dim(0, 7)
        })
        
        items["inline"] = library:create("Frame", {
            Parent = items["outline"],
            Position = dim2(0, 1, 0, 1),
            Size = dim2(1, -2, 1, -2),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(22, 22, 24)
        })
        
        library:create("UICorner", {
            Parent = items["inline"],
            CornerRadius = dim(0, 7)
        })
        
        items["scrolling"] = library:create("ScrollingFrame", {
            ScrollBarImageColor3 = rgb(44, 44, 46),
            Active = true,
            AutomaticCanvasSize = Enum.AutomaticSize.Y,
            ScrollBarThickness = 2,
            Parent = items["inline"],
            Size = dim2(1, 0, 1, -40),
            BackgroundTransparency = 1,
            Position = dim2(0, 0, 0, 35),
            BorderSizePixel = 0,
            CanvasSize = dim2(0, 0, 0, 0)
        })
        
        items["elements"] = library:create("Frame", {
            Parent = items["scrolling"],
            BackgroundTransparency = 1,
            Position = dim2(0, 10, 0, 10),
            Size = dim2(1, -20, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
        })
        
        library:create("UIListLayout", {
            Parent = items["elements"],
            Padding = dim(0, 10),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        library:create("UIPadding", {
            PaddingBottom = dim(0, 15),
            Parent = items["elements"]
        })
        
        items["button"] = library:create("TextButton", {
            FontFace = fonts.font,
            TextColor3 = rgb(255, 255, 255),
            Text = "",
            AutoButtonColor = false,
            Parent = items["outline"],
            Position = dim2(0, 1, 0, 1),
            Size = dim2(1, -2, 0, 35),
            BorderSizePixel = 0,
            TextSize = 16,
            BackgroundColor3 = rgb(19, 19, 21)
        })
        
        library:create("UICorner", {
            Parent = items["button"],
            CornerRadius = dim(0, 7)
        })
        
        items["Icon"] = library:create("ImageLabel", {
            ImageColor3 = themes.preset.accent,
            Parent = items["button"],
            AnchorPoint = vec2(0, 0.5),
            Image = cfg.icon,
            BackgroundTransparency = 1,
            Position = dim2(0, 10, 0.5, 0),
            Size = dim2(0, 22, 0, 22),
            BorderSizePixel = 0,
        })
        library:apply_theme(items["Icon"], "accent", "ImageColor3")
        
        items["section_title"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(255, 255, 255),
            Text = cfg.name,
            Parent = items["button"],
            Size = dim2(0, 0, 1, 0),
            Position = dim2(0, 40, 0, -1),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.X,
            TextSize = 16,
        })
        
        library:create("Frame", {
            AnchorPoint = vec2(0, 1),
            Parent = items["button"],
            Position = dim2(0, 0, 1, 0),
            Size = dim2(1, 0, 0, 1),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(36, 36, 37)
        })

        return setmetatable(cfg, library)
    end  
--

-- Toggle
    function library:toggle(options) 
        local cfg = {
            name = options.name or "Toggle",
            flag = options.flag or library:next_flag(),
            default = options.default or false,
            callback = options.callback or function() end,
            items = {},
            seperator = options.seperator or false,
            enabled = options.default or false,
        }

        flags[cfg.flag] = cfg.default

        local items = cfg.items
        
        items["toggle"] = library:create("TextButton", {
            FontFace = fonts.small,
            Text = "",
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
            TextSize = 14,
        })
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.small,
            TextColor3 = rgb(245, 245, 245),
            Text = cfg.name,
            Parent = items["toggle"],
            Size = dim2(1, 0, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })
        
        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })
        
        items["right_components"] = library:create("Frame", {
            Parent = items["toggle"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(0, 0, 1, 0),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
        })
        
        library:create("UIListLayout", {
            FillDirection = Enum.FillDirection.Horizontal,
            HorizontalAlignment = Enum.HorizontalAlignment.Right,
            Parent = items["right_components"],
            Padding = dim(0, 9),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        items["toggle_button"] = library:create("TextButton", {
            FontFace = fonts.font,
            Text = "",
            LayoutOrder = 2,
            AnchorPoint = vec2(1, 0.5),
            Parent = items["right_components"],
            Position = dim2(1, -9, 0.5, 0),
            Size = dim2(0, 36, 0, 18),
            BorderSizePixel = 0,
            TextSize = 14,
            BackgroundColor3 = rgb(58, 58, 62)
        })
        
        library:create("UICorner", {
            Parent = items["toggle_button"],
            CornerRadius = dim(0, 999)
        })
        
        items["inline"] = library:create("Frame", {
            Parent = items["toggle_button"],
            Size = dim2(1, -2, 1, -2),
            Position = dim2(0, 1, 0, 1),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(50, 50, 50)
        })
        
        library:create("UICorner", {
            Parent = items["inline"],
            CornerRadius = dim(0, 999)
        })
        
        items["circle"] = library:create("Frame", {
            Parent = items["inline"],
            Position = dim2(0, 2, 0, 2),
            Size = dim2(0, 12, 0, 12),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(86, 86, 88)
        })
        
        library:create("UICorner", {
            Parent = items["circle"],
            CornerRadius = dim(0, 999)
        })
        
        function cfg.set(bool)
            cfg.enabled = bool
            library:tween(items["toggle_button"], {BackgroundColor3 = bool and themes.preset.accent or rgb(58, 58, 62)}, Enum.EasingStyle.Quad)
            library:tween(items["inline"], {BackgroundColor3 = bool and themes.preset.accent or rgb(50, 50, 50)}, Enum.EasingStyle.Quad)
            library:tween(items["circle"], {
                BackgroundColor3 = bool and rgb(255, 255, 255) or rgb(86, 86, 88), 
                Position = bool and dim2(1, -14, 0, 2) or dim2(0, 2, 0, 2)
            }, Enum.EasingStyle.Quad)
            flags[cfg.flag] = bool
            cfg.callback(bool)
        end 
        
        items["toggle"].MouseButton1Click:Connect(function()
            cfg.enabled = not cfg.enabled 
            cfg.set(cfg.enabled)
        end)

        items["toggle_button"].MouseButton1Click:Connect(function()
            cfg.enabled = not cfg.enabled 
            cfg.set(cfg.enabled)
        end)
        
        if cfg.seperator then
            library:create("Frame", {
                AnchorPoint = vec2(0, 1),
                Parent = self.items["elements"],
                Position = dim2(0, 0, 1, 0),
                Size = dim2(1, 1, 0, 1),
                BorderSizePixel = 0,
                BackgroundColor3 = rgb(36, 36, 37)
            })
        end

        cfg.set(cfg.default)
        config_flags[cfg.flag] = cfg.set

        return setmetatable(cfg, library)
    end 
--

-- Slider
    function library:slider(options) 
        local cfg = {
            name = options.name or "Slider",
            suffix = options.suffix or "",
            flag = options.flag or library:next_flag(),
            callback = options.callback or function() end, 
            min = options.min or 0,
            max = options.max or 100,
            intervals = options.interval or 1,
            default = options.default or 10,
            value = options.default or 10, 
            seperator = options.seperator or false,
            dragging = false,
            items = {}
        } 

        flags[cfg.flag] = cfg.default

        local items = cfg.items
        
        items["slider_object"] = library:create("TextButton", {
            FontFace = fonts.small,
            Text = "",
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
            TextSize = 14,
        })
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.small,
            TextColor3 = rgb(245, 245, 245),
            Text = cfg.name,
            Parent = items["slider_object"],
            Size = dim2(1, 0, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })

        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })
        
        items["right_components"] = library:create("Frame", {
            Parent = items["slider_object"],
            BackgroundTransparency = 1,
            Position = dim2(0, 4, 0, 23),
            Size = dim2(1, 0, 0, 12),
            BorderSizePixel = 0,
        })
        
        library:create("UIListLayout", {
            Parent = items["right_components"],
            Padding = dim(0, 7),
            SortOrder = Enum.SortOrder.LayoutOrder,
            FillDirection = Enum.FillDirection.Horizontal
        })
        
        items["slider"] = library:create("TextButton", {
            FontFace = fonts.small,
            Text = "",
            AutoButtonColor = false,
            AnchorPoint = vec2(1, 0),
            Parent = items["right_components"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(1, -4, 0, 4),
            BorderSizePixel = 0,
            TextSize = 14,
            BackgroundColor3 = rgb(33, 33, 35)
        })
        
        library:create("UICorner", {
            Parent = items["slider"],
            CornerRadius = dim(0, 999)
        })
        
        items["fill"] = library:create("Frame", {
            Parent = items["slider"],
            Size = dim2(0.5, 0, 0, 4),
            BorderSizePixel = 0,
            BackgroundColor3 = themes.preset.accent
        })
        library:apply_theme(items["fill"], "accent", "BackgroundColor3")
        
        library:create("UICorner", {
            Parent = items["fill"],
            CornerRadius = dim(0, 999)
        })
        
        items["circle"] = library:create("Frame", {
            AnchorPoint = vec2(0.5, 0.5),
            Parent = items["fill"],
            Position = dim2(1, 0, 0.5, 0),
            Size = dim2(0, 12, 0, 12),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(244, 244, 244)
        })
        
        library:create("UICorner", {
            Parent = items["circle"],
            CornerRadius = dim(0, 999)
        })
        
        library:create("UIPadding", {
            Parent = items["right_components"],
            PaddingTop = dim(0, 4)
        })
        
        items["value"] = library:create("TextLabel", {
            FontFace = fonts.small,
            TextColor3 = rgb(72, 72, 73),
            Text = "50",
            Parent = items["slider_object"],
            Size = dim2(1, 0, 0, 0),
            Position = dim2(0, 6, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Right,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })
        
        library:create("UIPadding", {
            Parent = items["value"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })

        function cfg.set(value)
            cfg.value = clamp(library:round(value, cfg.intervals), cfg.min, cfg.max)
            library:tween(items["fill"], {Size = dim2((cfg.value - cfg.min) / (cfg.max - cfg.min), cfg.value == cfg.min and 0 or -4, 0, 2)}, Enum.EasingStyle.Linear, 0.05)
            items["value"].Text = tostring(cfg.value) .. cfg.suffix
            flags[cfg.flag] = cfg.value
            cfg.callback(cfg.value)
        end

        items["slider"].MouseButton1Down:Connect(function()
            cfg.dragging = true 
            library:tween(items["value"], {TextColor3 = rgb(255, 255, 255)}, Enum.EasingStyle.Quad, 0.2)
        end)

        library:connection(uis.InputChanged, function(input)
            if cfg.dragging and input.UserInputType == Enum.UserInputType.MouseMovement then 
                local size_x = (input.Position.X - items["slider"].AbsolutePosition.X) / items["slider"].AbsoluteSize.X
                local value = ((cfg.max - cfg.min) * size_x) + cfg.min
                cfg.set(value)
            end
        end)

        library:connection(uis.InputEnded, function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                cfg.dragging = false
                library:tween(items["value"], {TextColor3 = rgb(72, 72, 73)}, Enum.EasingStyle.Quad, 0.2) 
            end 
        end)

        if cfg.seperator then 
            library:create("Frame", {
                AnchorPoint = vec2(0, 1),
                Parent = self.items["elements"],
                Position = dim2(0, 0, 1, 0),
                Size = dim2(1, 1, 0, 1),
                BorderSizePixel = 0,
                BackgroundColor3 = rgb(36, 36, 37)
            })
        end 

        cfg.set(cfg.default)
        config_flags[cfg.flag] = cfg.set

        return setmetatable(cfg, library)
    end 
--

-- Dropdown
    function library:dropdown(options) 
        local cfg = {
            name = options.name or "Dropdown",
            flag = options.flag or library:next_flag(),
            options = options.items or {"Option 1", "Option 2"},
            callback = options.callback or function() end,
            multi = options.multi or false,
            width = options.width or 130,
            open = false,
            option_instances = {},
            multi_items = {},
            items = {},
            y_size = 0,
            seperator = options.seperator or false,
        }   

        cfg.default = options.default or (cfg.multi and {cfg.options[1]}) or cfg.options[1] or "None"
        flags[cfg.flag] = cfg.default

        local items = cfg.items
        
        items["dropdown_object"] = library:create("TextButton", {
            FontFace = fonts.small,
            Text = "",
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
            TextSize = 14,
        })
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.small,
            TextColor3 = rgb(245, 245, 245),
            Text = cfg.name,
            Parent = items["dropdown_object"],
            Size = dim2(1, 0, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })

        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })
        
        items["right_components"] = library:create("Frame", {
            Parent = items["dropdown_object"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(0, 0, 1, 0),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
        })
        
        library:create("UIListLayout", {
            FillDirection = Enum.FillDirection.Horizontal,
            HorizontalAlignment = Enum.HorizontalAlignment.Right,
            Parent = items["right_components"],
            Padding = dim(0, 7),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        items["dropdown"] = library:create("TextButton", {
            FontFace = fonts.small,
            Text = "",
            AutoButtonColor = false,
            AnchorPoint = vec2(1, 0),
            Parent = items["right_components"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(0, cfg.width, 0, 16),
            BorderSizePixel = 0,
            TextSize = 14,
            BackgroundColor3 = rgb(33, 33, 35)
        })
        
        library:create("UICorner", {
            Parent = items["dropdown"],
            CornerRadius = dim(0, 4)
        })
        
        items["sub_text"] = library:create("TextLabel", {
            FontFace = fonts.small,
            TextColor3 = rgb(86, 86, 87),
            Text = "",
            Parent = items["dropdown"],
            Size = dim2(1, -12, 0, 0),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            AutomaticSize = Enum.AutomaticSize.Y,
            TextSize = 14,
        })
        
        library:create("UIPadding", {
            Parent = items["sub_text"],
            PaddingTop = dim(0, 1),
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })

        items["dropdown_holder"] = library:create("Frame", {
            Parent = library["items"],
            Visible = true,
            BackgroundTransparency = 1,
            Size = dim2(0, 0, 0, 0),
            BorderSizePixel = 0,
            ZIndex = 10,
        })
        
        items["outline"] = library:create("Frame", {
            Parent = items["dropdown_holder"],
            Size = dim2(1, 0, 1, 0),
            ClipsDescendants = true,
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(33, 33, 35),
            ZIndex = 10,
        })
        
        library:create("UIPadding", {
            PaddingBottom = dim(0, 6),
            PaddingTop = dim(0, 3),
            PaddingLeft = dim(0, 3),
            Parent = items["outline"]
        })
        
        library:create("UIListLayout", {
            Parent = items["outline"],
            Padding = dim(0, 5),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        library:create("UICorner", {
            Parent = items["outline"],
            CornerRadius = dim(0, 4)
        })

        function cfg.render_option(text)
            local button = library:create("TextButton", {
                FontFace = fonts.small,
                TextColor3 = rgb(72, 72, 73),
                Text = text,
                Parent = items["outline"],
                Size = dim2(1, -12, 0, 0),
                BackgroundTransparency = 1,
                TextXAlignment = Enum.TextXAlignment.Left,
                BorderSizePixel = 0,
                AutomaticSize = Enum.AutomaticSize.Y,
                TextSize = 14,
                ZIndex = 10,
            })
            
            library:create("UIPadding", {
                Parent = button,
                PaddingTop = dim(0, 1),
                PaddingRight = dim(0, 5),
                PaddingLeft = dim(0, 5)
            })
            
            return button
        end
        
        function cfg.set_visible(bool)
            local a = bool and cfg.y_size or 0
            library:tween(items["dropdown_holder"], {Size = dim_offset(items["dropdown"].AbsoluteSize.X, a)})
            items["dropdown_holder"].Position = dim2(0, items["dropdown"].AbsolutePosition.X, 0, items["dropdown"].AbsolutePosition.Y + 80)
            library:close_element(cfg)
        end
        
        function cfg.set(value)
            local selected = {}
            local isTable = type(value) == "table"

            for _, option in pairs(cfg.option_instances) do 
                if option.Text == value or (isTable and find(value, option.Text)) then 
                    insert(selected, option.Text)
                    cfg.multi_items = selected
                    option.TextColor3 = themes.preset.accent
                else
                    option.TextColor3 = rgb(72, 72, 73)
                end
            end

            items["sub_text"].Text = isTable and concat(selected, ", ") or selected[1] or ""
            flags[cfg.flag] = isTable and selected or selected[1]
            cfg.callback(flags[cfg.flag]) 
        end
        
        function cfg.refresh_options(list) 
            cfg.y_size = 0
            for _, option in pairs(cfg.option_instances) do 
                option:Destroy() 
            end
            cfg.option_instances = {} 

            for _, option in ipairs(list) do 
                local button = cfg.render_option(option)
                cfg.y_size = cfg.y_size + button.AbsoluteSize.Y + 6
                insert(cfg.option_instances, button)
                
                button.MouseButton1Down:Connect(function()
                    if cfg.multi then 
                        local selected_index = find(cfg.multi_items, button.Text)
                        if selected_index then 
                            remove(cfg.multi_items, selected_index)
                        else
                            insert(cfg.multi_items, button.Text)
                        end
                        cfg.set(cfg.multi_items)
                    else 
                        cfg.set_visible(false)
                        cfg.open = false 
                        cfg.set(button.Text)
                    end
                end)
            end
        end

        items["dropdown"].MouseButton1Click:Connect(function()
            cfg.open = not cfg.open 
            cfg.set_visible(cfg.open)
        end)

        if cfg.seperator then 
            library:create("Frame", {
                AnchorPoint = vec2(0, 1),
                Parent = self.items["elements"],
                Position = dim2(0, 0, 1, 0),
                Size = dim2(1, 1, 0, 1),
                BorderSizePixel = 0,
                BackgroundColor3 = rgb(36, 36, 37)
            })
        end 

        config_flags[cfg.flag] = cfg.set
        cfg.refresh_options(cfg.options)
        cfg.set(cfg.default)
            
        return setmetatable(cfg, library)
    end
--

-- Label
    function library:label(options)
        local cfg = {
            name = options.name or "Label",
            seperator = options.seperator or false,
            items = {},
        }

        local items = cfg.items
        
        items["label"] = library:create("TextButton", {
            FontFace = fonts.small,
            Text = "",
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
            TextSize = 14,
        })
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.small,
            TextColor3 = rgb(245, 245, 245),
            Text = cfg.name,
            Parent = items["label"],
            Size = dim2(1, 0, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })
        
        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })
        
        items["right_components"] = library:create("Frame", {
            Parent = items["label"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(0, 0, 1, 0),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
        })
        
        library:create("UIListLayout", {
            FillDirection = Enum.FillDirection.Horizontal,
            HorizontalAlignment = Enum.HorizontalAlignment.Right,
            Parent = items["right_components"],
            Padding = dim(0, 9),
            SortOrder = Enum.SortOrder.LayoutOrder
        })

        if cfg.seperator then 
            library:create("Frame", {
                AnchorPoint = vec2(0, 1),
                Parent = self.items["elements"],
                Position = dim2(0, 0, 1, 0),
                Size = dim2(1, 1, 0, 1),
                BorderSizePixel = 0,
                BackgroundColor3 = rgb(36, 36, 37)
            })
        end 

        return setmetatable(cfg, library)
    end 
--

-- Colorpicker
    function library:colorpicker(options) 
        local cfg = {
            name = options.name or "Color", 
            flag = options.flag or library:next_flag(),
            color = options.color or color(1, 1, 1),
            alpha = options.alpha and 1 - options.alpha or 0,
            open = false, 
            callback = options.callback or function() end,
            items = {},
            seperator = options.seperator or false,
        }

        local dragging_sat = false 
        local dragging_hue = false 
        local dragging_alpha = false 

        local h, s, v = cfg.color:ToHSV() 
        local a = cfg.alpha 

        flags[cfg.flag] = {Color = cfg.color, Transparency = cfg.alpha}

        local label
        if not self.items.right_components then 
            label = self:label({name = cfg.name, seperator = cfg.seperator})
        end

        local items = cfg.items
        
        items["colorpicker"] = library:create("TextButton", {
            FontFace = fonts.small,
            Text = "",
            AutoButtonColor = false,
            AnchorPoint = vec2(1, 0),
            Parent = label and label.items.right_components or self.items["right_components"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(0, 16, 0, 16),
            BorderSizePixel = 0,
            TextSize = 14,
            BackgroundColor3 = cfg.color
        })
        
        library:create("UICorner", {
            Parent = items["colorpicker"],
            CornerRadius = dim(0, 4)
        })
        
        items["colorpicker_inline"] = library:create("Frame", {
            Parent = items["colorpicker"],
            Size = dim2(1, -2, 1, -2),
            Position = dim2(0, 1, 0, 1),
            BorderSizePixel = 0,
            BackgroundColor3 = cfg.color
        })
        
        library:create("UICorner", {
            Parent = items["colorpicker_inline"],
            CornerRadius = dim(0, 4)
        })

        items["colorpicker_holder"] = library:create("Frame", {
            Parent = library["other"],
            Position = dim2(0, 0, 0, 0),
            Size = dim2(0, 166, 0, 180),
            BorderSizePixel = 0,
            Visible = true,
            BackgroundColor3 = rgb(25, 25, 29)
        })
        
        library:create("UICorner", {
            Parent = items["colorpicker_holder"],
            CornerRadius = dim(0, 4)
        })

        items["colorpicker_components"] = library:create("Frame", {
            Parent = items["colorpicker_holder"],
            Position = dim2(0, 1, 0, 1),
            Size = dim2(1, -2, 1, -2),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(22, 22, 24)
        })
        
        library:create("UICorner", {
            Parent = items["colorpicker_components"],
            CornerRadius = dim(0, 6)
        })
        
        items["saturation_holder"] = library:create("Frame", {
            Parent = items["colorpicker_components"],
            Position = dim2(0, 7, 0, 7),
            Size = dim2(1, -14, 1, -60),
            BorderSizePixel = 0,
            BackgroundColor3 = hsv(h, 1, 1)
        })
        
        library:create("UICorner", {
            Parent = items["saturation_holder"],
            CornerRadius = dim(0, 4)
        })
        
        items["sat"] = library:create("TextButton", {
            Parent = items["saturation_holder"],
            Size = dim2(1, 0, 1, 0),
            Text = "",
            AutoButtonColor = false,
            ZIndex = 2,
            BorderSizePixel = 0,
                        BackgroundColor3 = rgb(255, 255, 255)
        })
        
        library:create("UICorner", {
            Parent = items["sat"],
            CornerRadius = dim(0, 4)
        })
        
        library:create("UIGradient", {
            Rotation = 270,
            Transparency = numseq{numkey(0, 0), numkey(1, 1)},
            Parent = items["sat"],
            Color = rgbseq{rgbkey(0, rgb(0, 0, 0)), rgbkey(1, rgb(0, 0, 0))}
        })
        
        items["val"] = library:create("Frame", {
            Parent = items["saturation_holder"],
            Size = dim2(1, 0, 1, 0),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(255, 255, 255)
        })
        
        library:create("UIGradient", {
            Parent = items["val"],
            Transparency = numseq{numkey(0, 0), numkey(1, 1)}
        })
        
        library:create("UICorner", {
            Parent = items["val"],
            CornerRadius = dim(0, 4)
        })
        
        items["satvalpicker"] = library:create("Frame", {
            AnchorPoint = vec2(0.5, 0.5),
            Parent = items["saturation_holder"],
            Position = dim2(s, 0, 1 - v, 0),
            Size = dim2(0, 8, 0, 8),
            ZIndex = 5,
            BorderSizePixel = 0,
            BackgroundColor3 = hsv(h, s, v)
        })
        
        library:create("UICorner", {
            Parent = items["satvalpicker"],
            CornerRadius = dim(0, 9999)
        })
        
        library:create("UIStroke", {
            Color = rgb(255, 255, 255),
            Parent = items["satvalpicker"],
            ApplyStrokeMode = Enum.ApplyStrokeMode.Border,
        })
        
        items["hue_gradient"] = library:create("TextButton", {
            Parent = items["colorpicker_components"],
            Position = dim2(0, 10, 1, -44),
            Size = dim2(1, -20, 0, 8),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(255, 255, 255),
            AutoButtonColor = false,
            Text = "",
        })
        
        library:create("UIGradient", {
            Color = rgbseq{rgbkey(0, rgb(255, 0, 0)), rgbkey(0.17, rgb(255, 255, 0)), rgbkey(0.33, rgb(0, 255, 0)), rgbkey(0.5, rgb(0, 255, 255)), rgbkey(0.67, rgb(0, 0, 255)), rgbkey(0.83, rgb(255, 0, 255)), rgbkey(1, rgb(255, 0, 0))},
            Parent = items["hue_gradient"]
        })
        
        library:create("UICorner", {
            Parent = items["hue_gradient"],
            CornerRadius = dim(0, 6)
        })
        
        items["hue_picker"] = library:create("Frame", {
            AnchorPoint = vec2(0.5, 0.5),
            Parent = items["hue_gradient"],
            Position = dim2(h, 0, 0.5, 0),
            Size = dim2(0, 8, 0, 8),
            ZIndex = 5,
            BorderSizePixel = 0,
            BackgroundColor3 = hsv(h, 1, 1)
        })
        
        library:create("UICorner", {
            Parent = items["hue_picker"],
            CornerRadius = dim(0, 9999)
        })
        
        library:create("UIStroke", {
            Color = rgb(255, 255, 255),
            Parent = items["hue_picker"],
            ApplyStrokeMode = Enum.ApplyStrokeMode.Border,
        })
        
        items["alpha_gradient"] = library:create("TextButton", {
            Parent = items["colorpicker_components"],
            Position = dim2(0, 10, 1, -26),
            Size = dim2(1, -20, 0, 8),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(25, 25, 29),
            AutoButtonColor = false,
            Text = "",
        })
        
        library:create("UICorner", {
            Parent = items["alpha_gradient"],
            CornerRadius = dim(0, 6)
        })
        
        library:create("UIGradient", {
            Color = rgbseq{rgbkey(0, rgb(0, 0, 0)), rgbkey(1, rgb(255, 255, 255))},
            Parent = items["alpha_gradient"]
        })
        
        items["alpha_picker"] = library:create("Frame", {
            AnchorPoint = vec2(0.5, 0.5),
            Parent = items["alpha_gradient"],
            Position = dim2(1 - a, 0, 0.5, 0),
            Size = dim2(0, 8, 0, 8),
            ZIndex = 5,
            BorderSizePixel = 0,
            BackgroundColor3 = hsv(h, 1, 1 - a)
        })
        
        library:create("UICorner", {
            Parent = items["alpha_picker"],
            CornerRadius = dim(0, 9999)
        })
        
        library:create("UIStroke", {
            Color = rgb(255, 255, 255),
            ApplyStrokeMode = Enum.ApplyStrokeMode.Border,
            Parent = items["alpha_picker"]
        })

        function cfg.set_visible(bool)
            items["colorpicker_holder"].Parent = bool and library["items"] or library["other"]
            items["colorpicker_holder"].Position = dim_offset(items["colorpicker"].AbsolutePosition.X, items["colorpicker"].AbsolutePosition.Y + items["colorpicker"].AbsoluteSize.Y + 45)
            library:close_element(cfg)
        end

        function cfg.set(new_color, alpha_val)
            if type(new_color) == "boolean" then return end 
            if new_color then h, s, v = new_color:ToHSV() end
            if alpha_val then a = alpha_val end 
            
            local Color = hsv(h, s, v)

            items["hue_picker"].Position = dim2(h, 0, 0.5, 0)
            items["alpha_picker"].Position = dim2(1 - a, 0, 0.5, 0)
            items["satvalpicker"].Position = dim2(s, 0, 1 - v, 0)
            
            items["colorpicker"].BackgroundColor3 = Color
            items["colorpicker_inline"].BackgroundColor3 = Color
            items["saturation_holder"].BackgroundColor3 = hsv(h, 1, 1)
            items["hue_picker"].BackgroundColor3 = hsv(h, 1, 1)
            items["alpha_picker"].BackgroundColor3 = hsv(h, 1, 1 - a)
            items["satvalpicker"].BackgroundColor3 = hsv(h, s, v)

            flags[cfg.flag] = {Color = Color, Transparency = a}
            cfg.callback(Color, a)
        end
        
        function cfg.update_color() 
            local mousePos = uis:GetMouseLocation() 
            local offset = vec2(mousePos.X, mousePos.Y - gui_offset) 

            if dragging_sat then    
                s = clamp((offset.X - items["sat"].AbsolutePosition.X) / items["sat"].AbsoluteSize.X, 0, 1)
                v = 1 - clamp((offset.Y - items["sat"].AbsolutePosition.Y) / items["sat"].AbsoluteSize.Y, 0, 1)
            elseif dragging_hue then
                h = clamp((offset.X - items["hue_gradient"].AbsolutePosition.X) / items["hue_gradient"].AbsoluteSize.X, 0, 1)
            elseif dragging_alpha then
                a = 1 - clamp((offset.X - items["alpha_gradient"].AbsolutePosition.X) / items["alpha_gradient"].AbsoluteSize.X, 0, 1)
            end

            cfg.set()
        end

        items["colorpicker"].MouseButton1Click:Connect(function()
            cfg.open = not cfg.open 
            cfg.set_visible(cfg.open)            
        end)

        uis.InputChanged:Connect(function(input)
            if (dragging_sat or dragging_hue or dragging_alpha) and input.UserInputType == Enum.UserInputType.MouseMovement then
                cfg.update_color() 
            end
        end)

        library:connection(uis.InputEnded, function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging_sat = false
                dragging_hue = false
                dragging_alpha = false
            end
        end)    

        items["alpha_gradient"].MouseButton1Down:Connect(function()
            dragging_alpha = true 
        end)
        
        items["hue_gradient"].MouseButton1Down:Connect(function()
            dragging_hue = true 
        end)
        
        items["sat"].MouseButton1Down:Connect(function()
            dragging_sat = true  
        end)
        
        cfg.set(cfg.color, cfg.alpha)
        config_flags[cfg.flag] = cfg.set

        return setmetatable(cfg, library)
    end 
--

-- Textbox
    function library:textbox(options) 
        local cfg = {
            name = options.name or "TextBox",
            placeholder = options.placeholder or "Type here...",
            default = options.default or "",
            flag = options.flag or library:next_flag(),
            callback = options.callback or function() end,
            items = {},
        }

        flags[cfg.flag] = cfg.default

        local items = cfg.items
        
        items["textbox"] = library:create("TextButton", {
            LayoutOrder = -1,
            FontFace = fonts.font,
            Text = "",
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
            TextSize = 14,
        })
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(245, 245, 245),
            Text = cfg.name,
            Parent = items["textbox"],
            Size = dim2(1, 0, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })
        
        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })
        
        items["right_components"] = library:create("Frame", {
            Parent = items["textbox"],
            BackgroundTransparency = 1,
            Position = dim2(0, 4, 0, 19),
            Size = dim2(1, 0, 0, 12),
            BorderSizePixel = 0,
        })
        
        library:create("UIListLayout", {
            Parent = items["right_components"],
            Padding = dim(0, 7),
            SortOrder = Enum.SortOrder.LayoutOrder,
            FillDirection = Enum.FillDirection.Horizontal
        })
        
        items["input"] = library:create("TextBox", {
            FontFace = fonts.font,
            Text = cfg.default,
            Parent = items["right_components"],
            TextTruncate = Enum.TextTruncate.AtEnd,
            BorderSizePixel = 0,
            PlaceholderText = cfg.placeholder,
            PlaceholderColor3 = rgb(100, 100, 100),
            CursorPosition = -1,
            ClearTextOnFocus = false,
            TextSize = 14,
            TextColor3 = rgb(200, 200, 200),
            Position = dim2(1, 0, 0, 0),
            Size = dim2(1, -4, 0, 30),
            BackgroundColor3 = rgb(33, 33, 35)
        })

        library:create("UICorner", {
            Parent = items["input"],
            CornerRadius = dim(0, 3)
        })
        
        library:create("UIPadding", {
            Parent = items["right_components"],
            PaddingTop = dim(0, 4),
            PaddingRight = dim(0, 4)
        })
        
        function cfg.set(text) 
            flags[cfg.flag] = text
            items["input"].Text = text
            cfg.callback(text)
        end 
        
        items["input"]:GetPropertyChangedSignal("Text"):Connect(function()
            cfg.set(items["input"].Text) 
        end)

        items["input"].Focused:Connect(function()
            library:tween(items["input"], {TextColor3 = rgb(245, 245, 245)})
        end)

        items["input"].FocusLost:Connect(function()
            library:tween(items["input"], {TextColor3 = rgb(200, 200, 200)})
        end)

        config_flags[cfg.flag] = cfg.set

        return setmetatable(cfg, library)
    end
--

-- Keybind
    function library:keybind(options) 
        local cfg = {
            flag = options.flag or library:next_flag(),
            callback = options.callback or function() end,
            name = options.name or nil, 
            key = options.key or nil, 
            mode = options.mode or "Toggle",
            active = options.default or false, 
            open = false,
            binding = nil, 
            hold_instances = {},
            items = {},
        }

        flags[cfg.flag] = {
            mode = cfg.mode,
            key = cfg.key, 
            active = cfg.active
        }

        local items = cfg.items
        
        items["keybind_element"] = library:create("TextButton", {
            FontFace = fonts.font,
            Text = "",
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
            TextSize = 14,
        })
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(245, 245, 245),
            Text = cfg.name or "Keybind",
            Parent = items["keybind_element"],
            Size = dim2(1, 0, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 16,
        })
        
        library:create("UIPadding", {
            Parent = items["name"],
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })
        
        items["right_components"] = library:create("Frame", {
            Parent = items["keybind_element"],
            Position = dim2(1, 0, 0, 0),
            Size = dim2(0, 0, 1, 0),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
        })
        
        library:create("UIListLayout", {
            FillDirection = Enum.FillDirection.Horizontal,
            HorizontalAlignment = Enum.HorizontalAlignment.Right,
            Parent = items["right_components"],
            Padding = dim(0, 7),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        items["keybind_holder"] = library:create("TextButton", {
            FontFace = fonts.font,
            Text = "",
            Parent = items["right_components"],
            AutoButtonColor = false,
            AnchorPoint = vec2(1, 0),
            Size = dim2(0, 0, 0, 16),
            Position = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.X,
            TextSize = 14,
            BackgroundColor3 = rgb(33, 33, 35)
        })
        
        library:create("UICorner", {
            Parent = items["keybind_holder"],
            CornerRadius = dim(0, 4)
        })
        
        items["key"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(86, 86, 87),
            Text = "None",
            Parent = items["keybind_holder"],
            Size = dim2(1, -12, 0, 0),
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 14,
        })
        
        library:create("UIPadding", {
            Parent = items["key"],
            PaddingTop = dim(0, 1),
            PaddingRight = dim(0, 5),
            PaddingLeft = dim(0, 5)
        })

        items["dropdown"] = library:create("Frame", {
            Parent = library["items"],
            BackgroundTransparency = 1,
            Position = dim2(0, 0, 0, 0),
            Size = dim2(0, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.X,
        })
        
        items["inline"] = library:create("Frame", {
            Parent = items["dropdown"],
            Size = dim2(1, 0, 1, 0),
            ClipsDescendants = true,
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(22, 22, 24)
        })
        
        library:create("UIPadding", {
            PaddingBottom = dim(0, 6),
            PaddingTop = dim(0, 3),
            PaddingLeft = dim(0, 3),
            Parent = items["inline"]
        })
        
        library:create("UIListLayout", {
            Parent = items["inline"],
            Padding = dim(0, 5),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        library:create("UICorner", {
            Parent = items["inline"],
            CornerRadius = dim(0, 4)
        })
        
        local mode_options = {"Hold", "Toggle", "Always"}
        cfg.y_size = 20
        
        for _, option in ipairs(mode_options) do                        
            local name = library:create("TextButton", {
                FontFace = fonts.font,
                TextColor3 = rgb(72, 72, 73),
                Text = option,
                Parent = items["inline"],
                Size = dim2(0, 0, 0, 0),
                BackgroundTransparency = 1,
                TextXAlignment = Enum.TextXAlignment.Left,
                BorderSizePixel = 0,
                AutomaticSize = Enum.AutomaticSize.XY,
                TextSize = 14,
            })
            cfg.hold_instances[option] = name
            cfg.y_size = cfg.y_size + name.AbsoluteSize.Y

            library:create("UIPadding", {
                Parent = name,
                PaddingTop = dim(0, 1),
                PaddingRight = dim(0, 5),
                PaddingLeft = dim(0, 5)
            })

            name.MouseButton1Click:Connect(function()
                cfg.set(option)
                cfg.set_visible(false)
                cfg.open = false
            end)
        end
        
        function cfg.modify_mode_color(path)
            for _, v in pairs(cfg.hold_instances) do 
                v.TextColor3 = rgb(72, 72, 72)
            end 
            if cfg.hold_instances[path] then
                cfg.hold_instances[path].TextColor3 = themes.preset.accent
            end
        end

        function cfg.set_mode(mode) 
            cfg.mode = mode 
            if mode == "Always" then
                cfg.set(true)
            elseif mode == "Hold" then
                cfg.set(false)
            end
            flags[cfg.flag]["mode"] = mode
            cfg.modify_mode_color(mode)
        end 

        function cfg.set(input)
            if type(input) == "boolean" then 
                cfg.active = input
                if cfg.mode == "Always" then cfg.active = true end
            elseif tostring(input):find("Enum") then 
                input = input.Name == "Escape" and "NONE" or input
                cfg.key = input or "NONE"   
            elseif find({"Toggle", "Hold", "Always"}, input) then 
                if input == "Always" then cfg.active = true end 
                cfg.mode = input
                cfg.set_mode(cfg.mode) 
            elseif type(input) == "table" then 
                if type(input.key) == "string" and input.key ~= "NONE" then
                    pcall(function()
                        input.key = library:convert_enum(input.key)
                    end)
                end
                if input.key == Enum.KeyCode.Escape then input.key = "NONE" end
                cfg.key = input.key or "NONE"
                cfg.mode = input.mode or "Toggle"
                if input.active then cfg.active = input.active end
                cfg.set_mode(cfg.mode) 
            end 

            cfg.callback(cfg.active)

            local text = "None"
            if cfg.key and tostring(cfg.key) ~= "Enums" and cfg.key ~= "NONE" then
                text = keys[cfg.key] or tostring(cfg.key):gsub("Enum.KeyCode.", ""):gsub("Enum.UserInputType.", "")
            end
            items["key"].Text = text

            flags[cfg.flag] = {
                mode = cfg.mode,
                key = cfg.key, 
                active = cfg.active
            }
        end

        function cfg.set_visible(bool)
            local size = bool and cfg.y_size or 0
            library:tween(items["dropdown"], {Size = dim_offset(items["keybind_holder"].AbsoluteSize.X, size)})
            items["dropdown"].Position = dim_offset(items["keybind_holder"].AbsolutePosition.X, items["keybind_holder"].AbsolutePosition.Y + items["keybind_holder"].AbsoluteSize.Y + 60)
        end
    
        items["keybind_holder"].MouseButton1Down:Connect(function()
            task.wait()
            items["key"].Text = "..."   

            cfg.binding = library:connection(uis.InputBegan, function(keycode, game_event)  
                cfg.set(keycode.KeyCode ~= Enum.KeyCode.Unknown and keycode.KeyCode or keycode.UserInputType)
                cfg.binding:Disconnect() 
                cfg.binding = nil
            end)
        end)

        items["keybind_holder"].MouseButton2Down:Connect(function()
            cfg.open = not cfg.open 
            cfg.set_visible(cfg.open)
        end)

        library:connection(uis.InputBegan, function(input, game_event) 
            if not game_event then
                local selected_key = input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode or input.UserInputType
                if selected_key == cfg.key then 
                    if cfg.mode == "Toggle" then 
                        cfg.active = not cfg.active
                        cfg.set(cfg.active)
                    elseif cfg.mode == "Hold" then 
                        cfg.set(true)
                    end
                end
            end
        end)    

        library:connection(uis.InputEnded, function(input, game_event) 
            if game_event then return end 
            local selected_key = input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode or input.UserInputType
            if selected_key == cfg.key then
                if cfg.mode == "Hold" then 
                    cfg.set(false)
                end
            end
        end)
        
        cfg.set({mode = cfg.mode, active = cfg.active, key = cfg.key})           
        config_flags[cfg.flag] = cfg.set

        return setmetatable(cfg, library)
    end
--

-- Button
    function library:button(options) 
        local cfg = {
            name = options.name or "Button",
            callback = options.callback or function() end,
            items = {},
        }
        
        local items = cfg.items
        
        items["button_element"] = library:create("Frame", {
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
        })
        
        items["button"] = library:create("TextButton", {
            FontFace = fonts.font,
            Text = "",
            AutoButtonColor = false,
            AnchorPoint = vec2(1, 0),
            Parent = items["button_element"],
            Position = dim2(1, -4, 0, 0),
            Size = dim2(1, -8, 0, 30),
            BorderSizePixel = 0,
            TextSize = 14,
            BackgroundColor3 = rgb(33, 33, 35)
        })
        
        library:create("UICorner", {
            Parent = items["button"],
            CornerRadius = dim(0, 3)
        })
        
        items["name"] = library:create("TextLabel", {
            FontFace = fonts.small,
            TextColor3 = rgb(245, 245, 245),
            Text = cfg.name,
            Parent = items["button"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 1, 0),
            BorderSizePixel = 0,
            TextSize = 14,
        })

        items["button"].MouseButton1Click:Connect(function()
            cfg.callback()
            items["name"].TextColor3 = themes.preset.accent 
            library:tween(items["name"], {TextColor3 = rgb(245, 245, 245)})
        end)
        
        return setmetatable(cfg, library)
    end 
--

-- Settings (Sub-settings)
    function library:settings(options)  
        local cfg = {
            open = false,
            items = {},
            sanity = true,
        }

        local items = cfg.items
        
        items["outline"] = library:create("Frame", {
            Visible = true,
            Parent = library["items"],
            Size = dim2(0, 0, 0, 0),
            ClipsDescendants = true,
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
            BackgroundColor3 = rgb(25, 25, 29)
        })
        
        items["inline"] = library:create("Frame", {
            Parent = items["outline"],
            Position = dim2(0, 1, 0, 1),
            Size = dim2(1, -2, 1, -2),
            BorderSizePixel = 0,
            BackgroundColor3 = rgb(22, 22, 24)
        })
        
        library:create("UICorner", {
            Parent = items["inline"],
            CornerRadius = dim(0, 7)
        })
        
        items["elements"] = library:create("Frame", {
            Parent = items["inline"],
            BackgroundTransparency = 1,
            Position = dim2(0, 10, 0, 10),
            Size = dim2(1, -20, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.Y,
        })
        
        library:create("UIListLayout", {
            Parent = items["elements"],
            Padding = dim(0, 10),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        library:create("UIPadding", {
            PaddingBottom = dim(0, 15),
            Parent = items["elements"]
        })
        
        library:create("UICorner", {
            Parent = items["outline"],
            CornerRadius = dim(0, 7)
        })
        
        items["tick"] = library:create("ImageButton", {
            Image = "rbxassetid://128797200442698",
            AutoButtonColor = false,
            Parent = self.items["right_components"],
            Size = dim2(0, 16, 0, 16),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
            ImageColor3 = rgb(150, 150, 150),
        })

        function cfg.set_visible(bool)                 
            library:tween(items["outline"], {Size = dim_offset(bool and 240 or 0, 0)})
            items["outline"].Position = dim_offset(items["tick"].AbsolutePosition.X, items["tick"].AbsolutePosition.Y + 90)
            library:close_element(cfg)
        end
        
        items["tick"].MouseButton1Click:Connect(function()
            cfg.open = not cfg.open
            cfg.set_visible(cfg.open)
        end)

        return setmetatable(cfg, library)
    end 
--

-- List
    function library:list(properties) 
        local cfg = {
            items = {},
            options = properties.options or {"1", "2", "3"},
            flag = properties.flag or library:next_flag(),
            callback = properties.callback or function() end,
            data_store = {},
            current_element = nil,
        }

        local items = cfg.items
        
        items["list"] = library:create("Frame", {
            Parent = self.items["elements"],
            BackgroundTransparency = 1,
            Size = dim2(1, 0, 0, 0),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
        })
        
        library:create("UIListLayout", {
            Parent = items["list"],
            Padding = dim(0, 10),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        library:create("UIPadding", {
            Parent = items["list"],
            PaddingRight = dim(0, 4),
            PaddingLeft = dim(0, 4)
        })

        function cfg.refresh_options(options_to_refresh)
            for _, option in pairs(cfg.data_store) do 
                option:Destroy()
            end
            cfg.data_store = {}

            for _, option_data in ipairs(options_to_refresh) do
                local button = library:create("TextButton", {
                    FontFace = fonts.small,
                    Text = "",
                    AutoButtonColor = false,
                    AnchorPoint = vec2(1, 0),
                    Parent = items["list"],
                    Position = dim2(1, 0, 0, 0),
                    Size = dim2(1, 0, 0, 30),
                    BorderSizePixel = 0,
                    TextSize = 14,
                    BackgroundColor3 = rgb(33, 33, 35)
                })
                cfg.data_store[#cfg.data_store + 1] = button

                local name = library:create("TextLabel", {
                    FontFace = fonts.font,
                    TextColor3 = rgb(72, 72, 73),
                    Text = option_data,
                    Parent = button,
                    BackgroundTransparency = 1,
                    Size = dim2(1, 0, 1, 0),
                    BorderSizePixel = 0,
                    AutomaticSize = Enum.AutomaticSize.XY,
                    TextSize = 14,
                })
                
                library:create("UICorner", {
                    Parent = button,
                    CornerRadius = dim(0, 3)
                })

                button.MouseButton1Click:Connect(function()
                    local current = cfg.current_element 
                    if current and current ~= name then 
                        library:tween(current, {TextColor3 = rgb(72, 72, 72)})
                    end
                    flags[cfg.flag] = option_data
                    cfg.callback(option_data)
                    library:tween(name, {TextColor3 = rgb(245, 245, 245)})
                    cfg.current_element = name
                end)

                name.MouseEnter:Connect(function()
                    if cfg.current_element == name then return end 
                    library:tween(name, {TextColor3 = rgb(140, 140, 140)})
                end)

                name.MouseLeave:Connect(function()
                    if cfg.current_element == name then return end 
                    library:tween(name, {TextColor3 = rgb(72, 72, 72)})
                end)
            end
        end

        cfg.refresh_options(cfg.options)

        return setmetatable(cfg, library)
    end 
--

-- Init Config
    function library:init_config(window) 
        library:load_library_settings()
        
        window:seperator({name = "Settings"})
        local main, settings_tab = window:tab({name = "Configs", tabs = {"Configs", "Settings"}})
        
        -- Configs Tab
        do
            local column = main:column({})
            local section = column:section({name = "Config List", size = 1, default = true})
            config_holder = section:list({options = {"No Configs"}, callback = function(option) end, flag = "config_name_list"})
            library:update_config_list()
            
            local column2 = main:column({})
            local section2 = column2:section({name = "Actions", size = 0.5, default = true})
            section2:textbox({name = "Config Name:", flag = "config_name_text", placeholder = "Enter name..."})
            
            section2:button({name = "Save", callback = function() 
                local config_name = flags["config_name_text"]
                if config_name == "" then config_name = flags["config_name_list"] end
                if config_name and config_name ~= "" and config_name ~= "No Configs" then
                    pcall(function()
                        writefile(library.directory .. "/configs/" .. config_name .. ".cfg", library:get_config()) 
                    end)
                    library:update_config_list() 
                    if notifications.enabled then
                        notifications:create_notification({name = "Saved", info = config_name}) 
                    end
                end
            end}) 
            
            section2:button({name = "Load", callback = function() 
                local config_name = flags["config_name_list"]
                if config_name and config_name ~= "No Configs" then
                    local path = library.directory .. "/configs/" .. config_name .. ".cfg"
                    pcall(function()
                        if isfile(path) then
                            library:load_config(readfile(path))
                            library:update_config_list() 
                            if notifications.enabled then
                                notifications:create_notification({name = "Loaded", info = config_name}) 
                            end
                        end
                    end)
                end
            end})
            
            section2:button({name = "Delete", callback = function() 
                local config_name = flags["config_name_list"]
                if config_name and config_name ~= "No Configs" then
                    local path = library.directory .. "/configs/" .. config_name .. ".cfg"
                    pcall(function()
                        if isfile(path) then
                            delfile(path)
                            library:update_config_list() 
                            if notifications.enabled then
                                notifications:create_notification({name = "Deleted", info = config_name}) 
                            end
                        end
                    end)
                end
            end})
            
            section2:button({name = "Refresh", callback = function() 
                library:update_config_list() 
            end})
            
            -- Auto Load
            local auto_section = column2:section({name = "Auto Load", size = 0.5, default = true})
            local current_auto = library.auto_load_config_name or "None"
            local auto_label = auto_section:label({name = "Current: " .. current_auto})
            
            auto_section:button({name = "Set Auto Load", callback = function()
                local config_name = flags["config_name_list"]
                if config_name and config_name ~= "No Configs" then
                    library:set_auto_load(config_name)
                    auto_label.items["name"].Text = "Current: " .. config_name
                    if notifications.enabled then
                        notifications:create_notification({name = "Auto Load", info = "Set: " .. config_name})
                    end
                end
            end})
            
            auto_section:button({name = "Remove Auto Load", callback = function()
                library:clear_auto_load()
                auto_label.items["name"].Text = "Current: None"
                if notifications.enabled then
                    notifications:create_notification({name = "Auto Load", info = "Removed"})
                end
            end})
        end
        
        -- Settings Tab
        do
            local column = settings_tab:column({})
            local ui_section = column:section({name = "UI", size = 1, default = true})
            
            ui_section:colorpicker({
                name = "Accent", 
                flag = "menu_accent",
                callback = function(clr, alpha) 
                    library:update_theme("accent", clr) 
                end, 
                color = themes.preset.accent
            })
            
            ui_section:keybind({
                name = "Menu Toggle", 
                flag = "menu_keybind",
                key = Enum.KeyCode.Insert,
                mode = "Toggle",
                default = true,
                callback = function(bool) 
                    window.toggle_menu(bool) 
                end
            })
            
            local column2 = settings_tab:column({})
            local notif_section = column2:section({name = "Notifications", size = 1, default = true})
            
            notif_section:toggle({
                name = "Enable Notifications", 
                flag = "notif_toggle",
                default = notifications.enabled,
                seperator = true,
                callback = function(bool) 
                    library:toggle_notifications(bool)
                    if bool then
                        notifications:create_notification({name = "Notifications", info = "Enabled!"})
                    end
                end
            })
            
            notif_section:button({name = "Test Notification", callback = function()
                if notifications.enabled then
                    notifications:create_notification({name = "Test", info = "Hello!", lifetime = 3})
                end
            end})
        end
        
        task.spawn(function()
            task.wait(0.5)
            library:do_auto_load()
        end)
    end
--

-- Notifications
    function notifications:refresh_notifs() 
        local offset = 50
        for _, v in pairs(notifications.notifs) do
            local Position = vec2(20, offset)
            library:tween(v, {Position = dim_offset(Position.X, Position.Y)}, Enum.EasingStyle.Quad, 0.4)
            offset = offset + v.AbsoluteSize.Y + 10
        end
        return offset
    end
    
    function notifications:fade(path, is_fading)
        local fading = is_fading and 1 or 0 
        library:tween(path, {BackgroundTransparency = fading}, Enum.EasingStyle.Quad, 1)
        for _, instance in pairs(path:GetDescendants()) do 
            pcall(function()
                if instance:IsA("UIStroke") then
                    library:tween(instance, {Transparency = fading}, Enum.EasingStyle.Quad, 1)
                elseif instance:IsA("TextLabel") then
                    library:tween(instance, {TextTransparency = fading})
                elseif instance:IsA("Frame") then
                    library:tween(instance, {BackgroundTransparency = is_fading and 1 or 0.6}, Enum.EasingStyle.Quad, 1)
                end
            end)
        end
    end 
    
    function notifications:create_notification(options)
        if not notifications.enabled then return end
        
        local cfg = {
            name = options.name or "Notification",
            info = options.info or "Info",
            lifetime = options.lifetime or 3,
            items = {},
        }

        local items = cfg.items
        
        items["notification"] = library:create("Frame", {
            Parent = library["items"],
            Size = dim2(0, 210, 0, 53),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
            AnchorPoint = vec2(1, 0),
            AutomaticSize = Enum.AutomaticSize.Y,
            BackgroundColor3 = rgb(14, 14, 16)
        })
        
        library:create("UIStroke", {
            Color = rgb(23, 23, 29),
            Parent = items["notification"],
            Transparency = 1,
            ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        })
        
        items["title"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(255, 255, 255),
            Text = cfg.name,
            Parent = items["notification"],
            BackgroundTransparency = 1,
            Position = dim2(0, 7, 0, 6),
            BorderSizePixel = 0,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 14,
        })
        
        library:create("UICorner", {
            Parent = items["notification"],
            CornerRadius = dim(0, 3)
        })
        
        items["info"] = library:create("TextLabel", {
            FontFace = fonts.font,
            TextColor3 = rgb(145, 145, 145),
            Text = cfg.info,
            Parent = items["notification"],
            Position = dim2(0, 9, 0, 22),
            BorderSizePixel = 0,
            BackgroundTransparency = 1,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true,
            AutomaticSize = Enum.AutomaticSize.XY,
            TextSize = 14,
        })
        
        library:create("UIPadding", {
            PaddingBottom = dim(0, 17),
            PaddingRight = dim(0, 8),
            Parent = items["info"]
        })
        
        items["bar"] = library:create("Frame", {
            AnchorPoint = vec2(0, 1),
            Parent = items["notification"],
            Position = dim2(0, 8, 1, -6),
            Size = dim2(0, 0, 0, 5),
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            BackgroundColor3 = themes.preset.accent
        })
        
        library:create("UICorner", {
            Parent = items["bar"],
            CornerRadius = dim(0, 999)
        })
        
        library:create("UIPadding", {
            PaddingRight = dim(0, 8),
            Parent = items["notification"]
        })
        
        local index = #notifications.notifs + 1
        notifications.notifs[index] = items["notification"]

        notifications:fade(items["notification"], false)
        
        local offset = notifications:refresh_notifs()
        items["notification"].Position = dim_offset(20, offset)

        library:tween(items["notification"], {AnchorPoint = vec2(0, 0)}, Enum.EasingStyle.Quad, 1)
        library:tween(items["bar"], {Size = dim2(1, -8, 0, 5)}, Enum.EasingStyle.Quad, cfg.lifetime)

        task.spawn(function()
            task.wait(cfg.lifetime)
            notifications.notifs[index] = nil
            notifications:fade(items["notification"], true)
            library:tween(items["notification"], {AnchorPoint = vec2(1, 0)}, Enum.EasingStyle.Quad, 1)
            task.wait(1)
            items["notification"]:Destroy() 
        end)
    end
--

return library
